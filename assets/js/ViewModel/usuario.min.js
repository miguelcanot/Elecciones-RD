function Usuario(){var e=this;e.IDusuario=ko.observable(),e.usuario=ko.observable(),e.nombre=ko.observable(),e.apellido=ko.observable(),e.correo=ko.observable(),e.comentario=ko.observable(),e.agente=ko.observable(),e.imagen=ko.observable(),e.estatus=ko.observable(),e.IDrol=ko.observable(),e.rol=ko.observable(),e.listaRol=ko.observableArray(),e.listaUsuario=ko.observableArray(),e.paginaActual=ko.observable(0),e.paginaFinal=ko.observable(!0),e.busqueda="",e.buscador=ko.observable(),e.modificando=ko.observable(!1),e.obtenerUsuario=function(a){a=a||0;var o="";if(""!=e.busqueda)var o=e.busqueda;var r=pathApi+"usuario/apiobtenerusuario/";disableBottonForm("frmBuscador","btnBuscar"),e.listaUsuario.removeAll(),$.post(r,{pagina:a,busqueda:o},function(a){if(a.estatus)if(a.resultado.length>0){var o=a.resultado;$.each(o,function(a,o){var r="A"==o.estatus?"<a class='label label-success' href='#' title='"+activo+"'><i class='fa fa-check'></i></a>":"P"==o.estatus?"<a class='label label-warning' href='#'><i class='fa fa-clock-o'></i></a>":("I"==o.estatus,"<a class='label label-danger' href='#'><i class='fa fa-times'></i></a>");r={icono:r,valor:o.estatus};var t=new Usuario;t.IDusuario(o.IDusuario),t.usuario(o.usuario),t.nombre(o.nombre),t.apellido(o.apellido),t.correo(o.correo),t.comentario(o.comentario),t.estatus(r),t.IDrol(o.IDrol),t.rol(o.rol),console.log(o.agente);var i="1"==o.agente?"<a class='label label-success' href='#' title='"+si+"'><i class='fa fa-check'></i></a>":"<a class='label label-danger' href='#' title='"+no+"'><i class='fa fa-times'></i></a>";i={icono:i,valor:o.agente},t.agente(i),e.listaUsuario.push(t)}),10==a.resultado.length?e.paginaFinal(!1):e.paginaFinal(!0)}else e.paginaActual(e.paginaActual()-1),e.paginaFinal(!0),mostrarMensajeE(error100);else mostrarMensajeE(a.mensaje);enableBottonForm("frmBuscador","btnBuscar")},"json").fail(function(e){enableBottonForm("frmBuscador","btnBuscar"),mostrarMensajeE(e.responseText)})},e.buscarKey=function(a,o){return 13==o.which&&e.buscar(),!0},e.buscar=function(){e.busqueda=$("#busqueda").val(),e.obtenerUsuario(0)},e.guardar=function(){e.modificando()?e.modificar():e.registrar()},e.estatusCambiado=function(a){e.estatus({valor:$("#estatus").val(),imagen:""}),e.estatus($("#estatus").val())},e.btnRegistrar=function(){e.modificando(!1),e.limpiar(),$("#modalUsuario").modal("show"),$("#nombre").focus()},e.registrar=function(){var a=pathApi+"usuario/apiregistrar";$("#frmUsuario").valid()&&(disableBottonForm("frmUsuario","btnGuardar"),$.post(a,$("#frmUsuario").serialize(),function(a){a.estatus?($("#modalUsuario").modal("hide"),e.limpiar(),mostrarMensajeS(a.mensaje),e.obtenerUsuario(0)):mostrarMensajeE(a.mensaje,"divMensajeEUsuario"),enableBottonForm("frmUsuario","btnGuardar")},"json").fail(function(e){enableBottonForm("frmUsuario","btnGuardar"),mostrarMensajeE(e.responseText,"divMensajeEUsuario")}))},e.btnModificar=function(a){e.limpiar(),e.modificando(!0),e.IDusuario(a.IDusuario()),e.nombre(a.nombre()),e.apellido(a.apellido()),e.usuario(a.usuario()),e.correo(a.correo()),e.IDrol(a.IDrol()),e.comentario(a.comentario()),e.agente(a.agente()),console.log(a.agente()),"1"==a.agente().valor?($("#agenteS").attr("checked","checked"),$("#agenteSLabel").addClass("active")):($("#agenteN").attr("checked","checked"),$("#agenteNLabel").addClass("active")),$("#IDrol").val(a.IDrol()),$("#modalUsuario").modal("show")},e.modificar=function(){var a=pathApi+"usuario/apimodificar";$("#frmUsuario").valid()&&(disableBottonForm("frmUsuario","btnGuardar"),$.post(a,$("#frmUsuario").serialize(),function(a){a.estatus?($("#modalUsuario").modal("hide"),mostrarMensajeS(a.mensaje),e.limpiar(),e.obtenerUsuario(0)):mostrarMensajeE(a.mensaje,"divMensajeEUsuario"),enableBottonForm("frmUsuario","btnGuardar")},"json").fail(function(e){enableBottonForm("frmUsuario","btnGuardar"),mostrarMensajeE(e.responseText,"divMensajeEUsuario")}))},e.eliminar=function(a){bootbox.confirm(mensajeConfirmacionEliminar,function(o){if(o){var r=pathApi+"usuario/apieliminar";disableBottonForm(),$.post(r,{IDusuario:a.IDusuario},function(o){o.estatus?(mostrarMensajeS(o.mensaje),e.listaUsuario().length>=10?e.obtenerUsuario(0):e.listaUsuario.remove(a)):mostrarMensajeE(o.mensaje),enableBottonForm()},"json").fail(function(e){enableBottonForm(),mostrarMensajeE(e.responseText)})}})},e.paginaSiguiente=function(){e.paginaActual(e.paginaActual()+1),e.obtenerUsuario(e.paginaActual())},e.paginaAnterior=function(){0!=e.paginaActual()&&(e.paginaActual(e.paginaActual()-1),e.obtenerUsuario(e.paginaActual())),e.paginaFinal(!1)},e.btnCancelar=function(){bootbox.confirm(mensajeConfirmacionModificar,function(a){a&&($("#modalUsuario").modal("hide"),e.limpiar())})},e.limpiar=function(){e.IDusuario(""),e.usuario(""),e.nombre(""),e.apellido(""),e.correo(""),e.comentario(""),e.imagen(""),e.estatus(""),e.agente(""),$("#agenteS").removeAttr("checked"),$("#agenteSLabel").removeClass("active"),$("#agenteN").removeAttr("checked"),$("#agenteNLabel").removeClass("active"),$("#frmUsuario").trigger("reset")},e.obtenerRol=function(){var a=pathApi+"rol/apiobtenerrolactivo";disableBottonForm(),$.post(a,function(a){if(a.estatus){var o=a.resultado;e.listaRol(o)}else mostrarMensajeE(a.mensaje);enableBottonForm()},"json").fail(function(e){enableBottonForm(),mostrarMensajeE(e.responseText)})}}var usuario=new Usuario;