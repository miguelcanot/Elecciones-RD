function Aplicacion(){var a=this;a.IDapp=ko.observable(),a.descripcion=ko.observable(),a.nombre=ko.observable(),a.fecha=ko.observable(),a.callback_url=ko.observable(),a.web=ko.observable(),a.img=ko.observable(),a.estatus=ko.observable(),a.listaAplicacion=ko.observableArray(),a.paginaActual=ko.observable(0),a.paginaFinal=ko.observable(!0),a.busqueda="",a.buscador=ko.observable(),a.modificando=ko.observable(!1),a.obtenerAplicacion=function(e){e=e||0;var i="";if(""!=a.busqueda)var i=a.busqueda;var o=pathApi+"aplicacion/apiobteneraplicacion/";disableBottonForm("","","lAplicacion"),a.listaAplicacion.removeAll(),$.post(o,{pagina:e,busqueda:i},function(e){if(e.estatus)if(e.resultado.length>0){var i=e.resultado;$.each(i,function(e,i){var o="A"==i.estatus?"<a class='label label-success' href='#' title='"+activo+"'><i class='fa fa-check'></i></a>":"P"==i.estatus?"<a class='label label-warning' href='#'><i class='fa fa-clock-o'></i></a>":("I"==i.estatus,"<a class='label label-danger' href='#'><i class='fa fa-times'></i></a>");o={icono:o,valor:i.estatus},i.estatus=o,a.listaAplicacion.push(i)}),10==e.resultado.length?a.paginaFinal(!1):a.paginaFinal(!0)}else a.paginaActual(a.paginaActual()-1),a.paginaFinal(!0),mostrarMensajeE(error100);else mostrarMensajeE(e.mensaje);enableBottonForm("","","lAplicacion")},"json").fail(function(a){enableBottonForm("","","lAplicacion"),mostrarMensajeE(a.responseText)})},a.obtenerAplicacionActivas=function(e){e=e||0;var i="";if(""!=a.busqueda)var i=a.busqueda;var o=pathApi+"aplicacion/apiobteneraplicacionactiva/";disableBottonForm("","","lJuegos"),a.listaAplicacion.removeAll(),$.post(o,{pagina:e,busqueda:i},function(e){if(e.estatus)if(e.resultado.length>0){var i=e.resultado;$.each(i,function(e,i){var o="A"==i.estatus?"<a class='label label-success' href='#' title='"+activo+"'><i class='fa fa-check'></i></a>":"P"==i.estatus?"<a class='label label-warning' href='#'><i class='fa fa-clock-o'></i></a>":("I"==i.estatus,"<a class='label label-danger' href='#'><i class='fa fa-times'></i></a>");o={icono:o,valor:i.estatus},i.estatus=o,a.listaAplicacion.push(i)}),10==e.resultado.length?a.paginaFinal(!1):a.paginaFinal(!0);var o=$(".masonry");$(o).imagesLoaded(function(){$(o).masonry({itemSelector:".post-grid",columnWidth:".post-grid"})})}else a.paginaActual(a.paginaActual()-1),a.paginaFinal(!0),mostrarMensajeE(error100);else mostrarMensajeE(e.mensaje);enableBottonForm("","","lJuegos")},"json").fail(function(a){enableBottonForm("","","lJuegos"),mostrarMensajeE(a.responseText)})},a.buscarKey=function(e,i){return 13==i.which&&a.buscar(),!0},a.buscar=function(){a.busqueda=$("#busqueda").val(),a.obtenerAplicacion(0)},a.guardar=function(){a.modificando()?a.modificar():a.registrar()},a.estatusCambiado=function(e){a.estatus({valor:$("#estatus").val(),imagen:""}),a.estatus($("#estatus").val())},a.btnRegistrar=function(){a.modificando(!1),a.limpiar(),$("#modalAplicacion").modal("show"),$("#nombre").focus()},a.registrar=function(){var e=pathApi+"aplicacion/apiregistrar";$("#frmAplicacion").valid()&&(disableBottonForm("frmAplicacion","btnGuardar","lmAplicacion"),$.post(e,$("#frmAplicacion").serialize(),function(e){e.estatus?($("#modalAplicacion").modal("hide"),a.limpiar(),mostrarMensajeS(e.mensaje),a.obtenerAplicacion(0)):mostrarMensajeE(e.mensaje),enableBottonForm("frmAplicacion","btnGuardar","lmAplicacion")},"json").fail(function(a){enableBottonForm("frmAplicacion","btnGuardar","lmAplicacion"),mostrarMensajeE(a.responseText,"divMensajeEAplicacion")}))},a.btnModificar=function(e){a.limpiar(),a.modificando(!0),a.IDapp(e.IDapp),a.descripcion(e.descripcion),a.nombre(e.nombre),a.callback_url(e.callback_url),a.web(e.web),$("#modalAplicacion").modal("show")},a.modificar=function(){var e=pathApi+"aplicacion/apimodificar";if($("#frmAplicacion").valid()){disableBottonForm("frmAplicacion","btnGuardar","lmAplicacion");var i=$("#frmAplicacion").serializefiles();$.ajax({type:"POST",url:e,contentType:!1,processData:!1,cache:!1,data:i,success:function(e){e=JSON.parse(e),e.estatus?($("#modalAplicacion").modal("hide"),mostrarMensajeS(e.mensaje),a.limpiar(),a.obtenerAplicacion(0)):mostrarMensajeE(e.mensaje),enableBottonForm("frmAplicacion","btnGuardar","lmAplicacion")},error:function(a,e){enableBottonForm("frmAplicacion","btnGuardar","lmAplicacion"),mostrarMensajeE(a.responseText)}})}},a.eliminar=function(e){bootbox.confirm(mensajeConfirmacionEliminar,function(i){if(i){var o=pathApi+"aplicacion/apieliminar";disableBottonForm("","","lAplicacion"),$.post(o,{ID:e.IDapp},function(i){i.estatus?(mostrarMensajeS(i.mensaje),a.listaAplicacion().length>=10?a.obtenerAplicacion(0):a.listaAplicacion.remove(e)):mostrarMensajeE(i.mensaje),enableBottonForm("","","lAplicacion")},"json").fail(function(a){enableBottonForm(),mostrarMensajeE(a.responseText)})}})},a.paginaSiguiente=function(){a.paginaActual(a.paginaActual()+1),a.obtenerAplicacion(a.paginaActual())},a.paginaAnterior=function(){0!=a.paginaActual()&&(a.paginaActual(a.paginaActual()-1),a.obtenerAplicacion(a.paginaActual())),a.paginaFinal(!1)},a.btnCancelar=function(){bootbox.confirm(mensajeConfirmacionModificar,function(e){e&&($("#modalAplicacion").modal("hide"),a.limpiar())})},a.limpiar=function(){a.IDapp(""),a.descripcion(""),a.nombre(""),a.web(""),a.callback_url(""),a.fecha(""),a.estatus(""),a.img(""),$("#frmAplicacion").trigger("reset")},a.getPermisoBoton=function(){var e=pathApi+"objeto/obtenerlistapermisoboton";disableBottonForm(),$.post(e,{pantalla:"aplicacion"},function(e){if(e.estatus){var i=e.resultado;$.each(i,function(e,i){"registrar"==i.nombre_fisico?a.btnRegistrarV(!0):"modificar"==i.nombre_fisico?a.btnModificarV(!0):"eliminar"==i.nombre_fisico&&a.btnEliminarV(!0)})}else mostrarMensajeE(e.mensaje);enableBottonForm()},"json").fail(function(a){enableBottonForm(),mostrarMensajeE(a.responseText)})},a.verAplicacion=function(a){redirect(pathWeb+a.callback_url)}}var aplicacion=new Aplicacion;