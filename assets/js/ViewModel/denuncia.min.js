function Denuncia(){var e=this;e.listaDenuncia=ko.observableArray(),e.listaTipoDenuncia=ko.observableArray(),e.listaDetalle=ko.observableArray(),e.paginaActual=ko.observable(0),e.paginaFinal=ko.observable(!0),e.busqueda="",e.urlImagen=ko.observable(),e.buscador=ko.observable(),e.modificando=ko.observable(!1),e.obtenerEstadisticaMunicipio=function(){var e=pathApi+"denuncia/apiobtenerestadisticamunicipio/";$.post(e,function(e){if(e.estatus){var a=e.resultado,n={type:"line",data:{labels:a.etiqueta,datasets:[{label:"Denuncias",data:a.valor,fill:!1,borderDash:[5,5]}]},options:{responsive:!0,title:{display:!1,text:""},tooltips:{mode:"label",callbacks:{}},hover:{mode:"dataset"}}},t=document.getElementById("canvas").getContext("2d");window.myLine=new Chart(t,n)}else mostrarMensajeE(e.mensaje)},"json").fail(function(e){mostrarMensajeE(e.responseText)})},e.obtenerEstadisticaRecinto=function(){var e=pathApi+"denuncia/apiobtenerestadisticarecinto/";$.post(e,function(e){if(e.estatus){var a=e.resultado,n={type:"line",data:{labels:a.etiqueta,datasets:[{label:"Denuncias",data:a.valor,fill:!1,borderDash:[5,5]}]},options:{responsive:!0,title:{display:!1,text:""},tooltips:{mode:"label",callbacks:{}},hover:{mode:"dataset"}}},t=document.getElementById("canvas").getContext("2d");window.myLine=new Chart(t,n)}else mostrarMensajeE(e.mensaje)},"json").fail(function(e){mostrarMensajeE(e.responseText)})},e.obtenerTipoDenuncia=function(){var a=pathApi+"denuncia/apiobtenertipodenunciaactivo/";e.listaTipoDenuncia.removeAll(),$.post(a,function(a){a.estatus?e.listaTipoDenuncia(a.resultado):mostrarMensajeE(a.mensaje)},"json").fail(function(e){mostrarMensajeE(e.responseText)})},e.registrar=function(){var a=pathApi+"denuncia/apiregistrar";if($("#frmDenuncia").valid()){disableBottonForm("frmDenuncia","btnGuardar","lDenuncia");var n=$("#frmDenuncia").serializefiles();$.ajax({type:"POST",url:a,contentType:!1,processData:!1,cache:!1,data:n,success:function(a){a=JSON.parse(a),a.estatus?(mostrarMensajeS(a.mensaje),e.limpiar(),redirect(pathWeb+"denuncia#")):mostrarMensajeE(a.mensaje),enableBottonForm("frmDenuncia","btnGuardar","lDenuncia")},error:function(e,a){enableBottonForm("frmDenuncia","btnGuardar","lDenuncia"),mostrarMensajeE(e.responseText)}})}},e.limpiar=function(){$("#IDRecinto").val("").trigger("change"),$("#IDMunicipio").val("").trigger("change"),recinto.listaRecinto.removeAll(),$("#frmDenuncia").trigger("reset")},e.obtenerDenuncia=function(a){a=a||0;var n="";if(""!=e.busqueda)var n=e.busqueda;var t=pathApi+"denuncia/apiobtenerdenuncia/";disableBottonForm("frmBuscador","btnBuscar","lDenuncia"),e.listaDenuncia.removeAll(),$.post(t,{pagina:a,busqueda:n},function(a){if(a.estatus)if(a.resultado.length>0){var n=a.resultado;$.each(n,function(a,n){var t="A"==n.Estatus?"<a class='label label-success' href='#' title='"+activo+"'><i class='fa fa-check'></i></a>":"P"==n.Estatus?"<a class='label label-warning' href='#'><i class='fa fa-clock-o'></i></a>":("I"==n.Estatus,"<a class='label label-danger' href='#'><i class='fa fa-times'></i></a>");t={icono:t,valor:n.Estatus},n.Estatus=t,e.listaDenuncia.push(n)}),10==a.resultado.length?e.paginaFinal(!1):e.paginaFinal(!0)}else e.paginaActual(e.paginaActual()-1),e.paginaFinal(!0),mostrarMensajeE(error100);else mostrarMensajeE(a.mensaje);enableBottonForm("frmBuscador","btnBuscar","lDenuncia")},"json").fail(function(e){enableBottonForm("frmBuscador","btnBuscar","lDenuncia"),mostrarMensajeE(e.responseText)})},e.buscarKey=function(a,n){return 13==n.which&&e.buscar(),!0},e.buscar=function(){e.busqueda=$("#busqueda").val(),e.obtenerDenuncia(0)},e.paginaSiguiente=function(){e.paginaActual(e.paginaActual()+1),e.obtenerColor(e.paginaActual())},e.paginaAnterior=function(){0!=e.paginaActual()&&(e.paginaActual(e.paginaActual()-1),e.obtenerColor(e.paginaActual())),e.paginaFinal(!1)},e.getPermisoBoton=function(){var a=pathApi+"objeto/obtenerlistapermisoboton";disableBottonForm(),$.post(a,{pantalla:"denuncia"},function(a){if(a.estatus){var n=a.resultado;$.each(n,function(a,n){"registrar"==n.NombreFisico?e.btnRegistrarV(!0):"modificar"==n.NombreFisico?e.btnModificarV(!0):"eliminar"==n.NombreFisico?e.btnEliminarV(!0):"permiso"==n.NombreFisico&&e.btnPermisoV(!0)})}else mostrarMensajeE(a.mensaje);enableBottonForm()},"json").fail(function(e){enableBottonForm(),mostrarMensajeE(e.responseText)})},e.eliminar=function(a){bootbox.confirm(mensajeConfirmacionEliminar,function(n){if(n){var t=pathApi+"denuncia/apieliminar";disableBottonForm("","","lDenuncia"),$.post(t,{ID:a.IDDenuncia},function(a){a.estatus?(mostrarMensajeS(a.mensaje),e.listaDenuncia().length>=10?e.obtenerDenuncia(e.paginaActual()):e.listaDenuncia.remove(color)):mostrarMensajeE(a.mensaje),enableBottonForm("","","lDenuncia")},"json").fail(function(e){enableBottonForm("","","lDenuncia"),mostrarMensajeE(e.responseText)})}})},e.aprobar=function(a){var n=pathApi+"denuncia/apiaprobar";disableBottonForm("","","lDenuncia"),$.post(n,{ID:a.IDDenuncia},function(a){a.estatus?(mostrarMensajeS(a.mensaje),e.obtenerDenuncia(e.paginaActual())):mostrarMensajeE(a.mensaje),enableBottonForm("","","lDenuncia")},"json").fail(function(e){enableBottonForm("","","lDenuncia"),mostrarMensajeE(e.responseText)})},e.detalle=function(a){var n=pathApi+"denuncia/apiobtenerdetalle";disableBottonForm("","","lDenuncia"),e.listaDetalle.removeAll(),$.post(n,{ID:a.IDDenuncia},function(a){a.estatus?(e.listaDetalle(a.resultado),$("#modalDetalle").modal("show")):mostrarMensajeE(a.mensaje),enableBottonForm("","","lDenuncia")},"json").fail(function(e){enableBottonForm("","","lDenuncia"),mostrarMensajeE(e.responseText)})},e.btnImagen=function(a){e.urlImagen(a.Imagen),$("#modalImagen").modal("show")}}var denuncia=new Denuncia;