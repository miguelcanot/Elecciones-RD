function Denuncia(){var a=this;a.listaDenuncia=ko.observableArray(),a.listaTipoDenuncia=ko.observableArray(),a.listaDetalle=ko.observableArray(),a.paginaActual=ko.observable(0),a.paginaFinal=ko.observable(!0),a.busqueda="",a.buscador=ko.observable(),a.modificando=ko.observable(!1),a.obtenerEstadisticaMunicipio=function(){var a=pathApi+"denuncia/apiobtenerestadisticamunicipio/";$.post(a,function(a){if(a.estatus){var e=a.resultado,o={type:"line",data:{labels:e.etiqueta,datasets:[{label:"Denuncias",data:e.valor,fill:!1,borderDash:[5,5]}]},options:{responsive:!0,title:{display:!1,text:""},tooltips:{mode:"label",callbacks:{}},hover:{mode:"dataset"}}},t=document.getElementById("canvas").getContext("2d");window.myLine=new Chart(t,o)}else mostrarMensajeE(a.mensaje)},"json").fail(function(a){mostrarMensajeE(a.responseText)})},a.obtenerEstadisticaRecinto=function(){var a=pathApi+"denuncia/apiobtenerestadisticarecinto/";$.post(a,function(a){if(a.estatus){var e=a.resultado,o={type:"line",data:{labels:e.etiqueta,datasets:[{label:"Denuncias",data:e.valor,fill:!1,borderDash:[5,5]}]},options:{responsive:!0,title:{display:!1,text:""},tooltips:{mode:"label",callbacks:{}},hover:{mode:"dataset"}}},t=document.getElementById("canvas").getContext("2d");window.myLine=new Chart(t,o)}else mostrarMensajeE(a.mensaje)},"json").fail(function(a){mostrarMensajeE(a.responseText)})},a.obtenerTipoDenuncia=function(){var e=pathApi+"denuncia/apiobtenertipodenunciaactivo/";a.listaTipoDenuncia.removeAll(),$.post(e,function(e){e.estatus?a.listaTipoDenuncia(e.resultado):mostrarMensajeE(e.mensaje)},"json").fail(function(a){mostrarMensajeE(a.responseText)})},a.registrar=function(){var e=pathApi+"denuncia/apiregistrar";$("#frmDenuncia").valid()&&(disableBottonForm("frmDenuncia","btnGuardar","lDenuncia"),$.post(e,$("#frmDenuncia").serialize(),function(e){e.estatus?(a.limpiar(),mostrarMensajeS(e.mensaje),redirect(pathWeb+"denuncia#")):mostrarMensajeE(e.mensaje),enableBottonForm("frmDenuncia","btnGuardar","lDenuncia")},"json").fail(function(a){enableBottonForm("frmDenuncia","btnGuardar","lDenuncia"),mostrarMensajeE(a.responseText)}))},a.limpiar=function(){$("#IDRecinto").val("").trigger("change"),$("#IDMunicipio").val("").trigger("change"),recinto.listaRecinto.removeAll(),$("#frmDenuncia").trigger("reset")},a.obtenerDenuncia=function(e){e=e||0;var o="";if(""!=a.busqueda)var o=a.busqueda;var t=pathApi+"denuncia/apiobtenerdenuncia/";disableBottonForm("frmBuscador","btnBuscar","lDenuncia"),a.listaDenuncia.removeAll(),$.post(t,{pagina:e,busqueda:o},function(e){if(e.estatus)if(e.resultado.length>0){var o=e.resultado;$.each(o,function(e,o){var t="A"==o.Estatus?"<a class='label label-success' href='#' title='"+activo+"'><i class='fa fa-check'></i></a>":"P"==o.Estatus?"<a class='label label-warning' href='#'><i class='fa fa-clock-o'></i></a>":("I"==o.Estatus,"<a class='label label-danger' href='#'><i class='fa fa-times'></i></a>");t={icono:t,valor:o.Estatus},o.Estatus=t,a.listaDenuncia.push(o)}),10==e.resultado.length?a.paginaFinal(!1):a.paginaFinal(!0)}else a.paginaActual(a.paginaActual()-1),a.paginaFinal(!0),mostrarMensajeE(error100);else mostrarMensajeE(e.mensaje);enableBottonForm("frmBuscador","btnBuscar","lDenuncia")},"json").fail(function(a){enableBottonForm("frmBuscador","btnBuscar","lDenuncia"),mostrarMensajeE(a.responseText)})},a.buscarKey=function(e,o){return 13==o.which&&a.buscar(),!0},a.buscar=function(){a.busqueda=$("#busqueda").val(),a.obtenerDenuncia(0)},a.paginaSiguiente=function(){a.paginaActual(a.paginaActual()+1),a.obtenerColor(a.paginaActual())},a.paginaAnterior=function(){0!=a.paginaActual()&&(a.paginaActual(a.paginaActual()-1),a.obtenerColor(a.paginaActual())),a.paginaFinal(!1)},a.getPermisoBoton=function(){var e=pathApi+"objeto/obtenerlistapermisoboton";disableBottonForm(),$.post(e,{pantalla:"denuncia"},function(e){if(e.estatus){var o=e.resultado;$.each(o,function(e,o){"registrar"==o.NombreFisico?a.btnRegistrarV(!0):"modificar"==o.NombreFisico?a.btnModificarV(!0):"eliminar"==o.NombreFisico?a.btnEliminarV(!0):"permiso"==o.NombreFisico&&a.btnPermisoV(!0)})}else mostrarMensajeE(e.mensaje);enableBottonForm()},"json").fail(function(a){enableBottonForm(),mostrarMensajeE(a.responseText)})},a.eliminar=function(e){bootbox.confirm(mensajeConfirmacionEliminar,function(o){if(o){var t=pathApi+"denuncia/apieliminar";disableBottonForm("","","lDenuncia"),$.post(t,{ID:e.IDDenuncia},function(e){e.estatus?(mostrarMensajeS(e.mensaje),a.listaDenuncia().length>=10?a.obtenerDenuncia(a.paginaActual()):a.listaDenuncia.remove(color)):mostrarMensajeE(e.mensaje),enableBottonForm("","","lDenuncia")},"json").fail(function(a){enableBottonForm("","","lDenuncia"),mostrarMensajeE(a.responseText)})}})},a.aprobar=function(e){var o=pathApi+"denuncia/apiaprobar";disableBottonForm("","","lDenuncia"),$.post(o,{ID:e.IDDenuncia},function(e){e.estatus?(mostrarMensajeS(e.mensaje),a.obtenerDenuncia(a.paginaActual())):mostrarMensajeE(e.mensaje),enableBottonForm("","","lDenuncia")},"json").fail(function(a){enableBottonForm("","","lDenuncia"),mostrarMensajeE(a.responseText)})},a.detalle=function(e){var o=pathApi+"denuncia/apiobtenerdetalle";disableBottonForm("","","lDenuncia"),a.listaDetalle.removeAll(),$.post(o,{ID:e.IDDenuncia},function(e){e.estatus?(a.listaDetalle(e.resultado),$("#modalDetalle").modal("show")):mostrarMensajeE(e.mensaje),enableBottonForm("","","lDenuncia")},"json").fail(function(a){enableBottonForm("","","lDenuncia"),mostrarMensajeE(a.responseText)})}}var denuncia=new Denuncia;